<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Union-Find - 競プロ実装メモ | sidearrow&#x27;s note</title><meta name="description" content="競技プログラミング実装メモシリーズ、Union-Find の実装メモです。"/><meta name="google-site-verification" content="EG93v2coQjmLHzGm4vQ8P7fbvn4qydBByilbqc4Fb1c"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/db8dab25eeda751543fc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/db8dab25eeda751543fc.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-f094e29a130fd0913879.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.daa7383ad2ab2e6757c1.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.286c5ad94e4334e87283.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-766318d03df867a1f3ab.js" as="script"/><link rel="preload" href="/_next/static/chunks/f3013900129fac922037dcbab00ee57d209137ff.388d31c0f652415fe4a1.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/article/%5BarticleId%5D-e946b8d4dbed38148faf.js" as="script"/></head><body><div id="__next"><div style="height:100vh;display:flex;flex-direction:column"><header><nav class="py-4 border-b"><div class="container flex justify-between"><a class="no-underline" href="/">sidearrow&#x27;s note</a></div></nav></header><main style="flex-grow:1"><div class="container"><i class="fas fa-external-link-alt"></i><div class="markdown-body my-20"><h1>Union-Find - 競プロ実装メモ</h1>
<h2>概要</h2>
<p>Union-Find は要素のグループ分けを木構造で管理するデータ構造です。</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> 個の要素があるとして、初期状態ではすべて別々のグループに属しています。
Union-Find は主に以下の機能を実現します。</p>
<ul>
<li>要素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> が属するグループと要素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> が属するグループを結合する</li>
<li>要素 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> が属するグループの根の要素を取得する</li>
</ul>
<h2>実装例</h2>
<ul>
<li>union by size と経路圧縮をしています</li>
</ul>
<pre class="hljs lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UnionFind</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, n)</span>:</span>
        self.par = [<span class="hljs-number">-1</span>] * n
        self.size = [<span class="hljs-number">1</span>] * n

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_root</span><span class="hljs-params">(self, x)</span>:</span>
        <span class="hljs-keyword">if</span> self.par[x] == <span class="hljs-number">-1</span>:
            <span class="hljs-keyword">return</span> x
        self.par[x] = self.get_root(self.par[x])
        <span class="hljs-keyword">return</span> self.par[x]

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">unite</span><span class="hljs-params">(self, x, y)</span>:</span>
        rx, ry = self.get_root(x), self.get_root(y)
        <span class="hljs-keyword">if</span> rx == ry:
            <span class="hljs-keyword">return</span>
        <span class="hljs-keyword">if</span> self.size[ry] &gt; self.size[rx]:
            rx, ry = ry, rx
        self.par[ry] = rx
        self.size[rx] += self.size[ry]
</pre>
</div></div></main><footer><div class="bg-gray-100 py-12"><div class="container text-center"><div class="mb-12"><div class="mb-4 font-bold">sidearrow&#x27;s note</div></div><div class="mb-12 flex justify-around"><div><a href="https://github.com/sidearrow" target="_blank" rel="noreferrer">GitHub</a></div><div><a href="https://twitter.com/__sidearrow" target="_blank" rel="noreferrer">Twitter</a></div></div><div class="text-sm text-gray-500">© 2020 sidearrow</div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"id":"compro-union-find","title":"Union-Find - 競プロ実装メモ","description":"競技プログラミング実装メモシリーズ、Union-Find の実装メモです。","createdAt":"2020/07/25","updatedAt":"2020/07/25","content":"\u003ch1\u003eUnion-Find - 競プロ実装メモ\u003c/h1\u003e\n\u003ch2\u003e概要\u003c/h2\u003e\n\u003cp\u003eUnion-Find は要素のグループ分けを木構造で管理するデータ構造です。\u003c/p\u003e\n\u003cp\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eN\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eN\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eN\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e 個の要素があるとして、初期状態ではすべて別々のグループに属しています。\nUnion-Find は主に以下の機能を実現します。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e要素 \u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e が属するグループと要素 \u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e が属するグループを結合する\u003c/li\u003e\n\u003cli\u003e要素 \u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e が属するグループの根の要素を取得する\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e実装例\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eunion by size と経路圧縮をしています\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre class=\"hljs lang-python\"\u003e\u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eUnionFind\u003c/span\u003e:\u003c/span\u003e\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003e__init__\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(self, n)\u003c/span\u003e:\u003c/span\u003e\n        self.par = [\u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e] * n\n        self.size = [\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e] * n\n\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eget_root\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(self, x)\u003c/span\u003e:\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.par[x] == \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e x\n        self.par[x] = self.get_root(self.par[x])\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e self.par[x]\n\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eunite\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(self, x, y)\u003c/span\u003e:\u003c/span\u003e\n        rx, ry = self.get_root(x), self.get_root(y)\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e rx == ry:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e self.size[ry] \u0026gt; self.size[rx]:\n            rx, ry = ry, rx\n        self.par[ry] = rx\n        self.size[rx] += self.size[ry]\n\u003c/pre\u003e\n","tags":["compro"]}},"__N_SSG":true},"page":"/article/[articleId]","query":{"articleId":"compro-union-find"},"buildId":"_lS6Jubv_rWS47FR7-YrU","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-2473c6643d514137e5d1.js"></script><script src="/_next/static/chunks/main-f094e29a130fd0913879.js" async=""></script><script src="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/_next/static/chunks/framework.daa7383ad2ab2e6757c1.js" async=""></script><script src="/_next/static/chunks/commons.286c5ad94e4334e87283.js" async=""></script><script src="/_next/static/chunks/pages/_app-766318d03df867a1f3ab.js" async=""></script><script src="/_next/static/chunks/f3013900129fac922037dcbab00ee57d209137ff.388d31c0f652415fe4a1.js" async=""></script><script src="/_next/static/chunks/pages/article/%5BarticleId%5D-e946b8d4dbed38148faf.js" async=""></script><script src="/_next/static/_lS6Jubv_rWS47FR7-YrU/_buildManifest.js" async=""></script><script src="/_next/static/_lS6Jubv_rWS47FR7-YrU/_ssgManifest.js" async=""></script></body></html>